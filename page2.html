<body onload="loadInsights()">

  <h1>Market Insights</h1>
  <div id="insights-container">
    <p>Loading insights...</p>
  </div>

  <script>
    async function loadInsights() {
      const params = new URLSearchParams(window.location.search);
      const country = params.get('country');
      if (!country) {
        document.getElementById('insights-container').innerHTML = "No country selected.";
        return;
      }

      const response = await fetch(`https://your-backend-url.com/api/generate?country=${encodeURIComponent(country)}`);
      const data = await response.json();

      if (data.result) {
        const sections = data.result.split(/\n(?=\d\.)/g);  // Splits on "1." "2." "3."
        document.getElementById('insights-container').innerHTML = `
          <h2>Overview Market</h2><p>${sections[0]?.replace(/^1\.\s*/, '')}</p>
          <h2>Latest News</h2><p>${sections[1]?.replace(/^2\.\s*/, '')}</p>
          <h2>Export Opportunities</h2><p>${sections[2]?.replace(/^3\.\s*/, '')}</p>
        `;
      } else {
        document.getElementById('insights-container').innerHTML = `<p>Error: ${data.error || "Failed to load insights."}</p>`;
      }
    }
  </script>
</body>
